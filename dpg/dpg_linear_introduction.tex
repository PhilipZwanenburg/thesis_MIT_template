\section{Linear DPG} \label{sec:dpg_linear}

In this section, we first outline the basic concepts of DPG methods in an abstract linear functional setting and then
provide a concrete example through the application of the theory to the linear advection equation.

\subsection{Abstract Functional Setting}

Much of the theory outlined below is borrowed directly from the works of Demkowicz et
al.~\cite{Demkowicz2014_overview,Demkowicz2017}. Of primary note, it is demonstrated that the DPG method can be
interpreted as the \emph{localization} of a method achieving optimal discrete stability through the choice of an
optimal conforming test space.

\subsubsection{A Discrete Petrov-Galerkin Variational Methodology with Optimal Stability}

Consider the \emph{linear} abstract variational problem
\begin{align} \label{eq:bilinear_abstract_infinite}
\text{Find}\ u \in \mathcal{U}\ \text{such that}\
b(v,u) = l(v)\ \forall v \in \mathcal{V},
\end{align}

where $\mathcal{U}$ and $\mathcal{V}$ denote the trial and test spaces, respectively, which are assumed to be Hilbert
spaces, and where the bilinear form $b(\cdot,\cdot)$ acting on $\mathcal{V} \times \mathcal{U}$ and the linear form
$l(\cdot)$ acting on $\mathcal{V}$ represent a particular variational formulation. It is assumed that the bilinear form
satisfies a continuity condition with continuity constant $M$,
\begin{align}
| b(v,u) | \le M ||u||_{\mathcal{U}} ||v||_{\mathcal{V}},
\end{align}

and an inf-sup condition with inf-sup constant $\gamma$,
\begin{align} \label{eq:inf_sup_infinite}
\exists \gamma > 0 :
\adjustlimits\inf_{u\in\mathcal{U}} \sup_{v\in\mathcal{V}}
\frac{b(v,u)}{||v||_{\mathcal{V}}||u||_{\mathcal{U}}} \ge \gamma.
\end{align}

Further, it is assumed that the linear form is continuous and satisfies the following compatibility condition
\begin{align}
l(v) = 0\ \forall v \in \mathcal{V}_0,\ \text{where}\ \mathcal{V}_0 \coloneqq \{v \in \mathcal{V} : b(v,u) = 0\ \forall u
\in \mathcal{U} \}.
\end{align}

% Special characters in text: https://tex.stackexchange.com/a/8859
Then, by the Banach-Ne\v{c}as-Babu\v{s}ka theorem \makered{(Add reference to Brener-Scott/Ciarlet)}, ~\eqref{eq:bilinear_abstract_infinite} has a unique solution, $u$, that depends continuously on the data,
\begin{align}
||u||_{\mathcal{U}} \le \frac{M}{\gamma} ||l||_{\mathcal{V}'},
\end{align}

where $\mathcal{V}'$ denotes the dual space of $\mathcal{V}$. Now let $\mathcal{U}_h \subset \mathcal{U}$ and $\mathcal{V}_h
\subset \mathcal{V}$ be finite dimensional trial and test spaces and consider the finite dimensional variation problem
\begin{align} \label{eq:bilinear_abstract_finite}
\text{Find}\ u_h \in \mathcal{U}_h\ \text{such that}\
b(v_h,u_h) = l(v_h)\ \forall v_h \in \mathcal{V}_h.
\end{align}

If the form satisfies the discrete inf-sup condition with inf-sup constant $\gamma_h$,
\begin{align} \label{eq:inf_sup_finite}
\exists \gamma_h > 0 :
\adjustlimits\inf_{u_h\in\mathcal{U}_h} \sup_{v_h\in\mathcal{V}_h}
\frac{b(v_h,u_h)}{||v_h||_{\mathcal{V}_h}||u_h||_{\mathcal{U}_h}} \ge \gamma_h,
\end{align}

then Babu\v{s}ka's theorem~\cite[Theorem \makeblue{2.2}]{Babuska1971}, demonstrates the discrete problem,
~\eqref{eq:bilinear_abstract_finite}, is well-posed with the Galerkin error satisfying the error estimate,
\begin{align} \label{eq:abstract_dpg_error}
||u_h-u||_{\mathcal{U}} \le \frac{M}{\gamma_h} \inf_{w_h \in \mathcal{U}_h} ||w_h-u||_{\mathcal{U}}.
\end{align}

where the original constant in the bound, $1 + \frac{M}{\gamma_h}$~\cite[eq. (\makeblue{2.14})]{Babuska1971}, has been
sharpened to $\frac{M}{\gamma_h}$ as demonstrated to be possible by Xu et al.~\cite[Theorem \makeblue{2}]{Xu2003}.
Generally, the well-posedness of the continuous problem does not imply the well-posedness of the discrete problem
(i.e.~\eqref{eq:inf_sup_infinite} $\centernot\implies$~\eqref{eq:inf_sup_finite}), and the fundamental motivation for
the DPG methodology is then to choose the test space such that the supremum in the discrete inf-sup
condition,~\eqref{eq:inf_sup_finite}, is obtained \makered{(Potentially refer to where it is proven that DPG test
functions are chosen in this way (following the demonstration in Demkowicz et al.~\cite[Section 4.1]{Demkowicz2017}))}.

A case of particular interest is then when the continuity and discrete inf-sup constants can be made equal,
\begin{align} \label{eq:equal_m_gamma}
M = \gamma_h,
\end{align}

so that the error incurred by the discrete approximation in~\eqref{eq:abstract_dpg_error} is smallest. As it is not
immediately clear which norms should be selected for the tiral and test spaces, the simplest strategy is to let the norm
be selected as that which is naturally induced by the problem such that~\eqref{eq:equal_m_gamma} is satisfied. Bui-Thanh
et al.~\cite[Theorem \makeblue{2.6}]{BuiThanh2013} have proven that $M = \gamma = 1$ if
\begin{align} \label{eq:bui_thanh_2-6}
\exists v_u \in \mathcal{V}\ \{0\} : b(v_u,u) = ||u||_{\mathcal{U}} ||v_u||_{\mathcal{V}}\ \forall u \in \mathcal{U}\ \{0\},
\end{align}

where $v_u$ is termed an optimal test function for the trial function $u$. Further, assuming
that~\eqref{eq:bui_thanh_2-6} holds,~\eqref{eq:equal_m_gamma} is satisfied when the discrete test space is defined by
\begin{align}
\mathcal{V} \supset \mathcal{V}_h = span \{ v_{u_h} \in \mathcal{V} : u_h \in \mathcal{U}_h \subset \mathcal{U}, b(v_{u_h},u_h) = ||u_h||_{\mathcal{U}}
||v_{u_h}||_{\mathcal{V}} \};
\end{align}

see Bui-Thanh et al.~\cite[Lemma \makeblue{2.8}]{BuiThanh2013}. Defining the map from trial to test space, $T :
\mathcal{U} \ni u \rightarrow Tu \coloneqq v_{Tu} \in \mathcal{V} $, by
\begin{align}
(v,Tu)_{\mathcal{V}} = b(v,u),
\end{align}

then
\begin{align} \label{eq:space_optimal_test}
\mathcal{V}_h = span \{ v_{T u_h} \in \mathcal{V} : u_h \in \mathcal{U}_h \};
\end{align}

see Bui-Thanh et al.~\cite[Theorem \makeblue{2.9}]{BuiThanh2013}. Defining the Riesz operator for the test inner product
$(\cdot,\cdot)_{\mathcal{V}}$,
\begin{align}
R_{\mathcal{V}} : \mathcal{V} \ni v \rightarrow (v,\cdot) \in \mathcal{V}',
\end{align}

which is an isometric isomorphism by the Riesz Representation Theorem \makered{(Add reference)}, the test functions
spanning $\mathcal{V}_h$ in~\eqref{eq:space_optimal_test}, which are henceforth referred to as \emph{optimal} test
functions, can be computed through the inversion of the Riesz operator by solving the auxiliary variational problem
\begin{align} \label{eq:bilinear_abstract_infinite}
\text{Find}\ v_{T u_h} \in \mathcal{V}\ \text{such that}\
(w,v_{T u_h})_{\mathcal{V}} = b(w,u_h),\ \forall w \in \mathcal{V}.
\end{align}

\subsubsection{DPG as a Localization of an Optimal Conforming PG Methodology}

Note that no assumptions regarding the conformity of the trial and test spaces have yet been made. The specification of
the `D' (discontinuous) in DPG, referring to a discontinuous test space, has not yet been made and the methodology of
this section is thus describing a general Petrov-Galerkin methodology. It will subsequently be demonstrated that the
use of non-conforming test spaces is a requirement for obtaining a \emph{practical} methodology \makered{(Add reference to
section where this is done)}.

\makered{Briefly reproduce the proof of \cite{Demkowicz2014_overview}, section 6 and make connections with DG.}
